<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns#">
  <head>
    <meta charset="utf-8">

    <link rel="apple-touch-icon" sizes="180x180" href="%PUBLIC_URL%/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="%PUBLIC_URL%/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="%PUBLIC_URL%/favicons/favicon-16x16.png">
    <link rel="mask-icon" href="%PUBLIC_URL%/favicons/safari-pinned-tab.svg" color="#a116b7">
    <link rel="shortcut icon" href="%PUBLIC_URL%/favicons/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#000000">

    <link rel="manifest" href="%PUBLIC_URL%/manifest.json">

    <!-- SEO -->
    <meta name="description" content="Audius is a music streaming and sharing platform that puts power back into the hands of content creators." data-react-helmet="true">

    <!-- Social -->
    <meta property="og:title" content="Audius - Empowering Creators">
    <meta property="og:site_name" content="Audius">
    <meta property="og:description" content="Audius is a music streaming and sharing platform that puts power back into the hands of content creators.">
    <meta property="og:image" content="%PUBLIC_URL%/ogImage.jpg">
    <meta property="fb:app_id" content="123553997750078" />

    <meta name="twitter:title" content="Audius - Empowering Creators">
    <meta name="twitter:description" content="Audius is a music streaming and sharing platform that puts power back into the hands of content creators.">
    <meta name="twitter:image" content="%PUBLIC_URL%/ogImage.jpg">
    <meta name="twitter:image:alt" content="The Audius Platform">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@AudiusProject">

    <link rel="preconnect" href="https://www.google-analytics.com" crossorigin>

    <script
      defer
      onLoad="window.web3Loaded = true; window.dispatchEvent(new CustomEvent('WEB3_LOADED'))"
      src="%PUBLIC_URL%/scripts/web3.min.js"
    ></script>

    <title>Audius</title>

    <script async type="text/javascript">
      // Account recovery
      try{
        const urlParams = new URLSearchParams(window.location.search)
        const useHashRouting = '%REACT_APP_USE_HASH_ROUTING%'
        const login = urlParams.get('login')
        const warning = urlParams.get('warning')

        let entropy = null
        if (login) {
          entropy = atob(login)
          window.localStorage.setItem('hedgehog-entropy-key', entropy)
          let redirectUrl = location.protocol + "//" + location.host
          if (useHashRouting) {
            redirectUrl += '/#'
          }
          redirectUrl += location.pathname
          window.history.replaceState({}, document.title, redirectUrl);
        }
        if (warning === 'RECOVERY_DO_NOT_SHARE') {
          const email = urlParams.get('email')
          window.localStorage.setItem('password-reset-required', email)
          let redirectUrl = location.protocol + "//" + location.host
          if (useHashRouting) {
            redirectUrl += '/#'
          }
          redirectUrl += location.pathname
          window.history.replaceState({}, document.title, redirectUrl);
          window.location = location.protocol + "//" + location.host + (useHashRouting ? '/#': '') + "/trending"
        }
      } catch(e){
        console.error(e)
      }
    </script>
    <!-- start Google Analytics -->
    <script async src="/analytics/gtag.js?id=%REACT_APP_GA_MEASUREMENT_ID%"></script>
    <script async>
      const nodeEnv = '%NODE_ENV%'
      const reactEnv = '%REACT_APP_ENVIRONMENT%'
      if (nodeEnv === 'production' && reactEnv === 'production') {
        try {
          window.dataLayer = window.dataLayer || [];
          // Stolen from https://github.com/gatsbyjs/gatsby/issues/11431
          function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', '%REACT_APP_GA_MEASUREMENT_ID%');
        } catch (e) {
          console.error(e)
        }
      }
    </script>
    <!-- end Google Analytics -->

    <!-- start reCAPTCHA -->
    <script>
      var onRecaptchaLoad = () => {
        grecaptcha.render('recaptcha-hidden', {
        'sitekey' : '%REACT_APP_RECAPTCHA_SITE_KEY%',
        'size': 'invisible',
        'expired-callback': () => null,
        'error-callback': () => null
      })
    }
    </script>
    <script src="https://www.google.com/recaptcha/api.js?onload=onRecaptchaLoad&render=%REACT_APP_RECAPTCHA_SITE_KEY%"></script>
    <!-- end reCAPTCHA -->

    <!-- start Segment -->
    <script defer type="text/javascript">
      const isNativeMobile = '%REACT_APP_NATIVE_MOBILE%'
      if (nodeEnv === 'production' && isNativeMobile !== 'true') {
        try {
          const userAgent = navigator.userAgent.toLowerCase()
          const isElectron = userAgent.indexOf(' electron/') > -1
          let isMobileCheck = false;
          (function (a) { if (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(a.substr(0, 4))) isMobileCheck = true })(navigator.userAgent || navigator.vendor || window.opera)
          // iPad iOS 13
          if (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1) isMobileCheck = true
          let segmentWriteKey = isMobileCheck ? '%REACT_APP_SEGMENT_MOBILE%' : '%REACT_APP_SEGMENT_WEB%'
          if (isElectron) {
            segmentWriteKey = '%REACT_APP_SEGMENT_ELECTRON%'
          }
          !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t,e){var n=document.createElement("script");n.type="text/javascript";n.async=!0;n.src="https://analytics.audius.co/"+t;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(n,a);analytics._loadOptions=e};analytics.SNIPPET_VERSION="4.1.0";
            analytics.load(segmentWriteKey)
          }}();

          if (window.analytics) {
            const SESSION_START = 'Session Start'
            let source
            if (isNativeMobile == 'true') {
              if (/android/i.test(userAgent)) source = 'Android App'
              else if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) source = 'iOS App'
              else source = 'Unknown App'
            } else if (isMobileCheck) {
              if (/windows phone/i.test(userAgent)) source = 'Windows Phone Web'
              else if (/android/i.test(userAgent)) source = 'Android Web'
              else if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) source = 'iOS Web'
              else source = 'Unknown Mobile Web'
            } else if (isElectron) {
              const platform = window.navigator.platform
              const macosPlatforms = ['Macintosh', 'MacIntel', 'MacPPC', 'Mac68K']
              const windowsPlatforms = ['Win32', 'Win64', 'Windows', 'WinCE']

              if (macosPlatforms.indexOf(platform) !== -1) source = 'MacOS'
              else if (windowsPlatforms.indexOf(platform) !== -1) source = 'Windows'
              else if (/Linux/.test(platform)) source = 'Linux'
              else source = 'Unknown Desktop'
            } else {
              source = 'Web'
            }

            window.analytics.track(SESSION_START, { source })
          }
        } catch (e) {
          console.error(e)
        }
      }
    </script>
    <!-- end Segment -->

    <!-- start Optimizely -->
    <script
      async
      onLoad="window.dispatchEvent(new CustomEvent('OPTIMIZELY_LOADED'))"
      onError="window.optimizelyDatafile = {}; window.dispatchEvent(new CustomEvent('OPTIMIZELY_LOADED'))"
      src="https://experiments.audius.co/datafiles/%REACT_APP_OPTIMIZELY_KEY%.json/tag.js">
    </script>
    <!-- end Optimizely -->

    <script>
      const fetchBItems = async () => {
        const bItemsUrl = '%REACT_APP_B_ITEMS_URL%'
        if (bItemsUrl) {
          try {
            window.bItems = new Set((await (await fetch(bItemsUrl)).json()).i)
          } catch (e) {
            window.bItems = new Set()
          }
        } else {
          window.bItems = new Set()
        }
        window.dispatchEvent(new CustomEvent('B_ITEMS_LOADED'))
      }
      fetchBItems()
    </script>

    <!-- TODO: Remove this when we compute average colors on the backend -->
    <link href="/scripts/jimp.min.js" as="script">
  </head>
  <body ontouchstart="">
    <noscript>
      You need to enable JavaScript to run this app.
    </noscript>
    <div id="root"></div>
    <div id="recaptcha-hidden" style='display: none;'></div>
  </body>
</html>
